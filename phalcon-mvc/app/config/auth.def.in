<?php

// 
// The source code is copyrighted, with equal shared rights, between the
// authors (see the file AUTHORS) and the OpenExam project, Uppsala University 
// unless otherwise explicit stated elsewhere.
// 
// File:    auth.def
// Created: 2014-08-25 15:09:23
// 
// Author:  Anders LÃ¶vgren (Computing Department at BMC, Uppsala University)
// 

use UUP\Authentication\Validator\LdapBindValidator,
    OpenExam\Library\Security\Authenticator\RemoteLogins\CasLogin,
    OpenExam\Library\Security\Authenticator\Formlogins\MsadLogin;

// 
// The chain of authenticator plugins for various services:
// 
return array(
        // 
        // SOAP service authentication:
        // 
        'soap' => array(
        ),
        // 
        // REST service authrntication:
        // 
        'rest' => array(
        ),
        // 
        // Web/AJAX service authentication:
        // 
        'web'  => array(
                'cas'  => (new CasLogin(
                        'cas.weblogin.uu.se', 443, '/cas'
                        ))
                        ->visible(true)
                        ->description('CAS Login')
                        ->name('cas'),
                'msad' => (new MsadLogin(
                    new LdapBindValidator('ldaps://akka-ldap.uu.se', 636), array(
                        'login' => '/msad',
                        'name'  => 'auth')
                    ))
                    ->visible(true)
                    ->description('Active Directory')
                    ->name('msad')
        ),
        // 
        // Common authentication plugins or restrictions:
        // 
        '*'    => array(
        )
);
